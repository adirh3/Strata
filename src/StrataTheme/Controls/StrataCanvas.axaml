<Styles xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:controls="using:StrataTheme.Controls">

  <Styles.Resources>
    <ResourceDictionary>
      <ControlTheme x:Key="{x:Type controls:StrataCanvas}" TargetType="controls:StrataCanvas">
        <Setter Property="Focusable" Value="True" />
        <Setter Property="Background" Value="{DynamicResource Brush.SurfaceCard}" />
        <Setter Property="BorderBrush" Value="{DynamicResource Brush.BorderSubtle}" />
        <Setter Property="BorderThickness" Value="{DynamicResource Stroke.Thin}" />
        <Setter Property="CornerRadius" Value="{DynamicResource Radius.Interactive}" />
        <Setter Property="Template">
          <ControlTemplate>
            <Border Name="PART_Root"
                    Background="{TemplateBinding Background}"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    BorderThickness="{TemplateBinding BorderThickness}"
                    CornerRadius="{TemplateBinding CornerRadius}"
                    BoxShadow="0 1 4 0 #10000000"
                    ClipToBounds="True">
              <Border.Transitions>
                <Transitions>
                  <BrushTransition Property="Background" Duration="0:0:0.14" />
                  <BrushTransition Property="BorderBrush" Duration="0:0:0.14" />
                  <BoxShadowsTransition Property="BoxShadow" Duration="0:0:0.20" />
                </Transitions>
              </Border.Transitions>

              <DockPanel>

                <Border Name="PART_ActivityTrack"
                        DockPanel.Dock="Top"
                        Height="2"
                        Background="{DynamicResource Brush.SubtleHover}"
                        ClipToBounds="True">
                  <Border Name="PART_ActivityBar"
                          Width="96"
                          Height="2"
                          HorizontalAlignment="Left"
                          Background="{DynamicResource Brush.StratumLine}"
                          Opacity="0" />
                </Border>

                <Border Name="PART_Header"
                        DockPanel.Dock="Top"
                        Padding="12,8,8,8">
                  <DockPanel LastChildFill="True">
                    <StackPanel DockPanel.Dock="Right"
                                Orientation="Horizontal"
                                Spacing="4"
                                VerticalAlignment="Center">

                      <ContentPresenter Name="PART_ToolBarPresenter"
                                        Content="{TemplateBinding ToolBar}"
                                        IsVisible="False"
                                        VerticalAlignment="Center" />

                      <Border Name="PART_ToolBarSep"
                              Width="1"
                              Height="14"
                              Background="{DynamicResource Brush.BorderSubtle}"
                              IsVisible="False" />

                      <Border Name="PART_VersionNav"
                              IsVisible="False"
                              Background="{DynamicResource Brush.ControlDefault}"
                              BorderBrush="{DynamicResource Brush.ControlElevationBorder}"
                              BorderThickness="{DynamicResource Stroke.Thin}"
                              CornerRadius="6"
                              Padding="1">
                        <StackPanel Orientation="Horizontal" Spacing="0">
                          <Button Name="PART_PrevButton" Classes="subtle" Padding="5,2" MinHeight="0" MinWidth="0" CornerRadius="4">
                            <TextBlock Text="◀" FontSize="8" Foreground="{DynamicResource Brush.TextTertiary}" />
                          </Button>
                          <TextBlock Text="{Binding Version, RelativeSource={RelativeSource TemplatedParent}, StringFormat='{}{0}'}"
                                     Margin="4,0,2,0"
                                     FontSize="11"
                                     FontWeight="SemiBold"
                                     Foreground="{DynamicResource Brush.TextSecondary}"
                                     VerticalAlignment="Center" />
                          <TextBlock Text="/" FontSize="11" Foreground="{DynamicResource Brush.TextTertiary}" VerticalAlignment="Center" />
                          <TextBlock Text="{Binding VersionCount, RelativeSource={RelativeSource TemplatedParent}, StringFormat='{}{0}'}"
                                     Margin="2,0,4,0"
                                     FontSize="11"
                                     Foreground="{DynamicResource Brush.TextTertiary}"
                                     VerticalAlignment="Center" />
                          <Button Name="PART_NextButton" Classes="subtle" Padding="5,2" MinHeight="0" MinWidth="0" CornerRadius="4">
                            <TextBlock Text="▶" FontSize="8" Foreground="{DynamicResource Brush.TextTertiary}" />
                          </Button>
                        </StackPanel>
                      </Border>

                      <Button Name="PART_CloseButton"
                              Classes="subtle"
                              Padding="6,4"
                              MinHeight="0"
                              MinWidth="0"
                              CornerRadius="6"
                              ToolTip.Tip="Close">
                        <TextBlock Text="✕" FontSize="10" Foreground="{DynamicResource Brush.TextTertiary}" />
                      </Button>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
                      <ContentPresenter Name="PART_IconPresenter"
                                        Content="{TemplateBinding Icon}"
                                        IsVisible="False"
                                        VerticalAlignment="Center" />
                      <StackPanel Spacing="0" VerticalAlignment="Center">
                        <TextBlock Text="{TemplateBinding Title}"
                                   FontSize="13"
                                   FontWeight="SemiBold"
                                   Foreground="{DynamicResource Brush.TextPrimary}" />
                        <TextBlock Name="PART_Subtitle"
                                   Text="{TemplateBinding Subtitle}"
                                   FontSize="11"
                                   Foreground="{DynamicResource Brush.TextTertiary}"
                                   IsVisible="False" />
                      </StackPanel>
                    </StackPanel>
                  </DockPanel>
                </Border>

                <Border DockPanel.Dock="Top"
                        Height="1"
                        Background="{DynamicResource Brush.BorderSubtle}"
                        Opacity="0.7" />

                <Border Name="PART_FooterSeparator"
                        DockPanel.Dock="Bottom"
                        Height="1"
                        Background="{DynamicResource Brush.BorderSubtle}"
                        Opacity="0.7"
                        IsVisible="False" />

                <Border Name="PART_Footer"
                        DockPanel.Dock="Bottom"
                        Padding="12,8,12,8"
                        IsVisible="False">
                  <ContentPresenter Content="{TemplateBinding Footer}" />
                </Border>

                <Border Name="PART_ContentHost"
                        Margin="8"
                        CornerRadius="8"
                        Background="{DynamicResource Brush.Surface1}"
                        BorderBrush="{DynamicResource Brush.BorderSubtle}"
                        BorderThickness="{DynamicResource Stroke.Thin}"
                        ClipToBounds="True">
                  <ScrollViewer VerticalScrollBarVisibility="Auto"
                                HorizontalScrollBarVisibility="Disabled">
                    <ContentPresenter Content="{TemplateBinding Content}" Margin="14,12,14,12" />
                  </ScrollViewer>
                </Border>

              </DockPanel>
            </Border>
          </ControlTemplate>
        </Setter>

        <Style Selector="^:has-subtitle /template/ TextBlock#PART_Subtitle">
          <Setter Property="IsVisible" Value="True" />
        </Style>

        <Style Selector="^:has-icon /template/ ContentPresenter#PART_IconPresenter">
          <Setter Property="IsVisible" Value="True" />
        </Style>

        <Style Selector="^:has-toolbar /template/ ContentPresenter#PART_ToolBarPresenter">
          <Setter Property="IsVisible" Value="True" />
        </Style>

        <Style Selector="^:has-toolbar /template/ Border#PART_ToolBarSep">
          <Setter Property="IsVisible" Value="True" />
        </Style>

        <Style Selector="^:has-footer /template/ Border#PART_Footer">
          <Setter Property="IsVisible" Value="True" />
        </Style>

        <Style Selector="^:has-footer /template/ Border#PART_FooterSeparator">
          <Setter Property="IsVisible" Value="True" />
        </Style>

        <Style Selector="^:has-footer /template/ Border#PART_ContentHost">
          <Setter Property="Margin" Value="8,8,8,0" />
          <Setter Property="CornerRadius" Value="8,8,0,0" />
        </Style>

        <Style Selector="^:has-versions /template/ Border#PART_VersionNav">
          <Setter Property="IsVisible" Value="True" />
        </Style>

        <Style Selector="^[ShowCloseButton=False] /template/ Button#PART_CloseButton">
          <Setter Property="IsVisible" Value="False" />
        </Style>

        <Style Selector="^:generating /template/ Border#PART_ActivityTrack">
          <Setter Property="Background" Value="{DynamicResource Brush.AccentSubtle}" />
        </Style>

        <Style Selector="^:generating /template/ Border#PART_Root">
          <Setter Property="BorderBrush" Value="{DynamicResource Brush.AccentSubtleHover}" />
        </Style>

        <Style Selector="^:pointerover /template/ Border#PART_Root">
          <Setter Property="Background" Value="{DynamicResource Brush.SurfaceCardHover}" />
          <Setter Property="BorderBrush" Value="{DynamicResource Brush.BorderDefault}" />
          <Setter Property="BoxShadow" Value="0 4 16 0 #14000000" />
        </Style>

        <Style Selector="^:focus-visible /template/ Border#PART_Root">
          <Setter Property="BorderBrush" Value="{DynamicResource Brush.AccentDefault}" />
        </Style>
      </ControlTheme>
    </ResourceDictionary>
  </Styles.Resources>
</Styles>
