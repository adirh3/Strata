<Styles xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <Styles.Resources>
    <ResourceDictionary>

      <ControlTheme x:Key="{x:Type ToggleSwitch}" TargetType="ToggleSwitch">
        <Setter Property="Transitions" Value="{x:Null}" />
        <Setter Property="KnobTransitions">
          <Transitions>
            <DoubleTransition Property="Canvas.Left" Duration="0:0:0.18" Easing="CubicEaseOut" />
          </Transitions>
        </Setter>
        <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}" />
        <Setter Property="FontFamily" Value="{DynamicResource Font.Family}" />
        <Setter Property="FontSize" Value="{DynamicResource Font.SizeBody}" />
        <Setter Property="Cursor" Value="Hand" />
        <Setter Property="Padding" Value="0" />
        <Setter Property="OnContent" Value="" />
        <Setter Property="OffContent" Value="" />
        <Setter Property="Template">
          <ControlTemplate>
            <Grid ColumnDefinitions="Auto,12,*" Background="Transparent">

              <Grid Grid.Column="0" HorizontalAlignment="Left" VerticalAlignment="Center">
                <!-- Off track (visible when unchecked) -->
                <Border x:Name="OuterBorder"
                        Width="40" Height="20" CornerRadius="10"
                        Background="{DynamicResource Brush.ControlPressed}"
                        BorderBrush="{DynamicResource Brush.BorderStrong}"
                        BorderThickness="1"
                        BoxShadow="0 0 0 0 #00000000">
                  <Border.Transitions>
                    <Transitions>
                      <DoubleTransition Property="Opacity" Duration="0:0:0.16" />
                      <BrushTransition Property="Background" Duration="0:0:0.12" />
                      <BoxShadowsTransition Property="BoxShadow" Duration="0:0:0.16" />
                    </Transitions>
                  </Border.Transitions>
                </Border>

                <!-- On track (visible when checked) -->
                <Border x:Name="SwitchKnobBounds"
                        Width="40" Height="20" CornerRadius="10"
                        Background="{DynamicResource Brush.AccentGradient}"
                        BorderBrush="{DynamicResource Brush.AccentDefault}"
                        BorderThickness="1"
                        Opacity="0"
                        RenderTransformOrigin="0.5,0.5"
                        RenderTransform="scaleX(0.96) scaleY(0.96)"
                        BoxShadow="0 0 0 0 #00000000">
                  <Border.Transitions>
                    <Transitions>
                      <DoubleTransition Property="Opacity" Duration="0:0:0.16" />
                      <TransformOperationsTransition Property="RenderTransform" Duration="0:0:0.18" Easing="CubicEaseOut" />
                      <BrushTransition Property="Background" Duration="0:0:0.12" />
                      <BrushTransition Property="BorderBrush" Duration="0:0:0.12" />
                      <BoxShadowsTransition Property="BoxShadow" Duration="0:0:0.16" />
                    </Transitions>
                  </Border.Transitions>
                </Border>

                <Border x:Name="SwitchFlash"
                        Width="40"
                        Height="20"
                        CornerRadius="10"
                        Background="{DynamicResource Brush.StratumLine}"
                        Opacity="0"
                        RenderTransformOrigin="0.5,0.5"
                        RenderTransform="scaleX(0.7)"
                        IsHitTestVisible="False" />

                <!-- Knob canvas â€” the control sets Canvas.Left on PART_MovingKnobs -->
                <Canvas x:Name="PART_SwitchKnob"
                        Width="20" Height="20"
                        HorizontalAlignment="Left">
                  <Grid x:Name="PART_MovingKnobs"
                        Width="20"
                        Height="20"
                        RenderTransformOrigin="0.5,0.5"
                        RenderTransform="scaleX(1) scaleY(1)">
                    <Grid.Transitions>
                      <Transitions>
                        <TransformOperationsTransition Property="RenderTransform" Duration="0:0:0.14" Easing="CubicEaseOut" />
                      </Transitions>
                    </Grid.Transitions>
                    <Ellipse x:Name="SwitchKnobOff"
                             Fill="{DynamicResource Brush.TextSecondary}"
                             Width="12" Height="12">
                      <Ellipse.Transitions>
                        <Transitions>
                          <DoubleTransition Property="Width" Duration="0:0:0.12" Easing="CubicEaseOut" />
                          <DoubleTransition Property="Height" Duration="0:0:0.12" Easing="CubicEaseOut" />
                          <DoubleTransition Property="Opacity" Duration="0:0:0.14" />
                        </Transitions>
                      </Ellipse.Transitions>
                    </Ellipse>
                    <Ellipse x:Name="SwitchKnobOn"
                             Fill="White"
                             Width="12" Height="12"
                             Opacity="0">
                      <Ellipse.Transitions>
                        <Transitions>
                          <DoubleTransition Property="Width" Duration="0:0:0.12" Easing="CubicEaseOut" />
                          <DoubleTransition Property="Height" Duration="0:0:0.12" Easing="CubicEaseOut" />
                          <DoubleTransition Property="Opacity" Duration="0:0:0.14" />
                        </Transitions>
                      </Ellipse.Transitions>
                    </Ellipse>
                  </Grid>
                </Canvas>
              </Grid>

              <!-- On/Off content presenters (hidden, but required by control) -->
              <ContentPresenter x:Name="PART_OffContentPresenter"
                                Grid.Column="2"
                                Content="{TemplateBinding OffContent}"
                                ContentTemplate="{TemplateBinding OffContentTemplate}"
                                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                VerticalAlignment="Center"
                                Opacity="0"
                                IsHitTestVisible="False" />
              <ContentPresenter x:Name="PART_OnContentPresenter"
                                Grid.Column="2"
                                Content="{TemplateBinding OnContent}"
                                ContentTemplate="{TemplateBinding OnContentTemplate}"
                                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                VerticalAlignment="Center"
                                Opacity="0"
                                IsHitTestVisible="False" />

              <!-- Main content/label -->
              <ContentPresenter x:Name="PART_ContentPresenter"
                                Grid.Column="2"
                                Content="{TemplateBinding Content}"
                                ContentTemplate="{TemplateBinding ContentTemplate}"
                                VerticalAlignment="Center"
                                RenderTransformOrigin="0,0.5"
                                RenderTransform="translateX(0px)" />
            </Grid>
          </ControlTemplate>
        </Setter>

        <!-- Hover: knob grows -->
        <Style Selector="^:pointerover">
          <Style Selector="^ /template/ Border#OuterBorder">
            <Setter Property="Background" Value="{DynamicResource Brush.ControlHover}" />
            <Setter Property="BorderBrush" Value="{DynamicResource Brush.BorderStrong}" />
            <Setter Property="BoxShadow" Value="0 0 0 1 #1A000000" />
          </Style>
          <Style Selector="^ /template/ Ellipse#SwitchKnobOff">
            <Setter Property="Width" Value="14" />
            <Setter Property="Height" Value="14" />
          </Style>
          <Style Selector="^ /template/ Ellipse#SwitchKnobOn">
            <Setter Property="Width" Value="14" />
            <Setter Property="Height" Value="14" />
          </Style>
          <Style Selector="^ /template/ Border#SwitchKnobBounds">
            <Setter Property="Background" Value="{DynamicResource Brush.AccentGradientHover}" />
            <Setter Property="BorderBrush" Value="{DynamicResource Brush.AccentHover}" />
          </Style>
        </Style>

        <!-- Pressed: knob squishes horizontally -->
        <Style Selector="^:pressed">
          <Style Selector="^ /template/ Border#OuterBorder">
            <Setter Property="Background" Value="{DynamicResource Brush.ControlPressed}" />
          </Style>
          <Style Selector="^ /template/ Ellipse#SwitchKnobOff">
            <Setter Property="Width" Value="17" />
            <Setter Property="Height" Value="14" />
          </Style>
          <Style Selector="^ /template/ Ellipse#SwitchKnobOn">
            <Setter Property="Width" Value="17" />
            <Setter Property="Height" Value="14" />
          </Style>
          <Style Selector="^ /template/ Border#SwitchKnobBounds">
            <Setter Property="Background" Value="{DynamicResource Brush.AccentGradientPressed}" />
            <Setter Property="BorderBrush" Value="{DynamicResource Brush.AccentPressed}" />
          </Style>
          <Style Selector="^ /template/ Grid#PART_MovingKnobs">
            <Setter Property="RenderTransform" Value="scaleX(0.9) scaleY(0.9)" />
          </Style>
        </Style>

        <!-- Checked: swap track visibility + flash pop -->
        <Style Selector="^:checked">
          <Style Selector="^ /template/ Border#OuterBorder">
            <Setter Property="Opacity" Value="0" />
          </Style>
          <Style Selector="^ /template/ Border#SwitchKnobBounds">
            <Setter Property="Opacity" Value="1" />
            <Setter Property="RenderTransform" Value="scaleX(1) scaleY(1)" />
            <Setter Property="BoxShadow" Value="0 0 0 1 #1E4F46E5" />
          </Style>
          <Style Selector="^ /template/ Border#SwitchFlash">
            <Setter Property="RenderTransform" Value="scaleX(1)" />
            <Style.Animations>
              <Animation Duration="0:0:0.5" FillMode="Forward">
                <KeyFrame Cue="0%">
                  <Setter Property="Opacity" Value="0.55" />
                </KeyFrame>
                <KeyFrame Cue="35%">
                  <Setter Property="Opacity" Value="0.28" />
                </KeyFrame>
                <KeyFrame Cue="100%">
                  <Setter Property="Opacity" Value="0" />
                </KeyFrame>
              </Animation>
            </Style.Animations>
          </Style>
          <Style Selector="^ /template/ Grid#PART_MovingKnobs">
            <Setter Property="RenderTransform" Value="scaleX(1.06) scaleY(1.06)" />
          </Style>
          <Style Selector="^ /template/ ContentPresenter#PART_ContentPresenter">
            <Setter Property="RenderTransform" Value="translateX(1px)" />
            <Setter Property="Opacity" Value="1" />
          </Style>
          <Style Selector="^ /template/ Ellipse#SwitchKnobOff">
            <Setter Property="Opacity" Value="0" />
          </Style>
          <Style Selector="^ /template/ Ellipse#SwitchKnobOn">
            <Setter Property="Opacity" Value="1" />
            <Style.Animations>
              <Animation Duration="0:0:0.4" FillMode="Forward">
                <KeyFrame Cue="0%">
                  <Setter Property="Width" Value="10" />
                  <Setter Property="Height" Value="10" />
                </KeyFrame>
                <KeyFrame Cue="45%">
                  <Setter Property="Width" Value="15" />
                  <Setter Property="Height" Value="15" />
                </KeyFrame>
                <KeyFrame Cue="75%">
                  <Setter Property="Width" Value="11" />
                  <Setter Property="Height" Value="11" />
                </KeyFrame>
                <KeyFrame Cue="100%">
                  <Setter Property="Width" Value="12" />
                  <Setter Property="Height" Value="12" />
                </KeyFrame>
              </Animation>
            </Style.Animations>
          </Style>
        </Style>

        <!-- Unchecked: settle + flash fade -->
        <Style Selector="^:unchecked">
          <Style Selector="^ /template/ Border#OuterBorder">
            <Setter Property="Opacity" Value="1" />
          </Style>
          <Style Selector="^ /template/ Border#SwitchKnobBounds">
            <Setter Property="Opacity" Value="0" />
            <Setter Property="RenderTransform" Value="scaleX(0.96) scaleY(0.96)" />
          </Style>
          <Style Selector="^ /template/ Border#SwitchFlash">
            <Setter Property="RenderTransform" Value="scaleX(0.7)" />
            <Style.Animations>
              <Animation Duration="0:0:0.35" FillMode="Forward">
                <KeyFrame Cue="0%">
                  <Setter Property="Opacity" Value="0.3" />
                </KeyFrame>
                <KeyFrame Cue="100%">
                  <Setter Property="Opacity" Value="0" />
                </KeyFrame>
              </Animation>
            </Style.Animations>
          </Style>
          <Style Selector="^ /template/ Grid#PART_MovingKnobs">
            <Setter Property="RenderTransform" Value="scaleX(1) scaleY(1)" />
          </Style>
          <Style Selector="^ /template/ ContentPresenter#PART_ContentPresenter">
            <Setter Property="RenderTransform" Value="translateX(0px)" />
            <Setter Property="Opacity" Value="0.95" />
          </Style>
          <Style Selector="^ /template/ Ellipse#SwitchKnobOff">
            <Setter Property="Opacity" Value="1" />
            <Style.Animations>
              <Animation Duration="0:0:0.35" FillMode="Forward">
                <KeyFrame Cue="0%">
                  <Setter Property="Width" Value="14" />
                  <Setter Property="Height" Value="14" />
                </KeyFrame>
                <KeyFrame Cue="50%">
                  <Setter Property="Width" Value="10" />
                  <Setter Property="Height" Value="10" />
                </KeyFrame>
                <KeyFrame Cue="100%">
                  <Setter Property="Width" Value="12" />
                  <Setter Property="Height" Value="12" />
                </KeyFrame>
              </Animation>
            </Style.Animations>
          </Style>
          <Style Selector="^ /template/ Ellipse#SwitchKnobOn">
            <Setter Property="Opacity" Value="0" />
          </Style>
        </Style>

        <Style Selector="^:disabled">
          <Setter Property="Opacity" Value="0.5" />
        </Style>
      </ControlTheme>

    </ResourceDictionary>
  </Styles.Resources>
</Styles>
