<Styles xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:controls="using:StrataTheme.Controls">

  <Styles.Resources>
    <ResourceDictionary>
      <ControlTheme x:Key="{x:Type controls:StrataAiAgent}" TargetType="controls:StrataAiAgent">
        <Setter Property="Focusable" Value="True" />
        <Setter Property="Template">
          <ControlTemplate>
            <Panel>
              <Border Name="PART_FocusRing"
                      CornerRadius="12"
                      BorderThickness="2"
                      BorderBrush="Transparent"
                      Margin="-2"
                      IsHitTestVisible="False" />

              <Border Name="PART_Root"
                      Background="{DynamicResource Brush.SurfaceCard}"
                      BorderBrush="{DynamicResource Brush.BorderSubtle}"
                      BorderThickness="1"
                      CornerRadius="12"
                      ClipToBounds="True">
                <Border.Transitions>
                  <Transitions>
                    <BrushTransition Property="Background" Duration="0:0:0.14" />
                    <BrushTransition Property="BorderBrush" Duration="0:0:0.14" />
                    <BoxShadowsTransition Property="BoxShadow" Duration="0:0:0.2" />
                  </Transitions>
                </Border.Transitions>

                <StackPanel Spacing="0">
                  <Border Name="PART_Stratum"
                          Height="2.5"
                          Background="{DynamicResource Brush.StratumLine}" />

                  <Border Name="PART_Header"
                          Cursor="Hand"
                          Padding="14,12"
                          Background="Transparent">
                    <StackPanel Spacing="10">
                      <Grid ColumnDefinitions="Auto,10,*">
                        <Border Width="32" Height="32"
                                CornerRadius="8"
                                Background="{DynamicResource Brush.AccentSubtle}">
                          <TextBlock Text="{TemplateBinding IconGlyph}"
                                     FontSize="15"
                                     FontWeight="SemiBold"
                                     Foreground="{DynamicResource Brush.AccentDefault}"
                                     HorizontalAlignment="Center"
                                     VerticalAlignment="Center" />
                        </Border>

                        <StackPanel Grid.Column="2" Spacing="2" VerticalAlignment="Center">
                          <TextBlock Text="{TemplateBinding AgentName}"
                                     FontSize="14"
                                     FontWeight="SemiBold"
                                     TextTrimming="CharacterEllipsis" />
                          <TextBlock Name="PART_Description"
                                     Text="{TemplateBinding Description}"
                                     FontSize="12"
                                     LineHeight="18"
                                     Foreground="{DynamicResource Brush.TextSecondary}"
                                     MaxLines="2"
                                     TextTrimming="CharacterEllipsis"
                                     TextWrapping="Wrap" />
                        </StackPanel>
                      </Grid>

                      <WrapPanel Orientation="Horizontal">
                        <Border Background="{DynamicResource Brush.Surface1}"
                                CornerRadius="6"
                                Padding="9,3"
                                Margin="0,0,6,0">
                          <TextBlock Text="{Binding ToolsCount, RelativeSource={RelativeSource TemplatedParent}, StringFormat='Tools {0}'}"
                                     FontSize="10.5"
                                     FontWeight="SemiBold"
                                     Foreground="{DynamicResource Brush.TextSecondary}" />
                        </Border>
                        <Border Background="{DynamicResource Brush.Surface1}"
                                CornerRadius="6"
                                Padding="9,3">
                          <TextBlock Text="{Binding SkillsCount, RelativeSource={RelativeSource TemplatedParent}, StringFormat='Skills {0}'}"
                                     FontSize="10.5"
                                     FontWeight="SemiBold"
                                     Foreground="{DynamicResource Brush.TextSecondary}" />
                        </Border>
                      </WrapPanel>
                    </StackPanel>
                  </Border>

                  <Border Name="PART_Detail"
                          ClipToBounds="True"
                          MaxHeight="0"
                          Opacity="0"
                          Padding="14,0,14,14"
                          RenderTransformOrigin="0.5,0"
                          RenderTransform="translateY(-6px) scaleY(0.96)">
                    <Border.Transitions>
                      <Transitions>
                        <DoubleTransition Property="MaxHeight" Duration="0:0:0.32" Easing="CubicEaseOut" />
                        <DoubleTransition Property="Opacity" Duration="0:0:0.24" />
                        <TransformOperationsTransition Property="RenderTransform" Duration="0:0:0.28" Easing="CubicEaseOut" />
                      </Transitions>
                    </Border.Transitions>

                    <StackPanel Spacing="12">
                      <Border Height="1" Background="{DynamicResource Brush.BorderSubtle}" />

                      <TabControl Name="PART_TabHost" MinHeight="160">
                        <TabItem Name="PART_OverviewTab" Header="Overview">
                          <Border Background="{DynamicResource Brush.Surface0}"
                                  BorderBrush="{DynamicResource Brush.BorderSubtle}"
                                  BorderThickness="1"
                                  CornerRadius="8"
                                  Padding="12,10"
                                  Margin="0,8,0,0">
                            <StackPanel Spacing="8">
                              <TextBlock Name="PART_EmptyText"
                                         IsVisible="False"
                                         Text="No overview detail is available."
                                         FontSize="12"
                                         Foreground="{DynamicResource Brush.TextTertiary}" />
                              <controls:StrataMarkdown Name="PART_Markdown"
                                                       ShowTitle="False"
                                                       Markdown="{TemplateBinding DetailMarkdown}" />
                            </StackPanel>
                          </Border>
                        </TabItem>

                        <TabItem Name="PART_SkillsTab" Header="Skills">
                          <Border Background="{DynamicResource Brush.Surface0}"
                                  BorderBrush="{DynamicResource Brush.BorderSubtle}"
                                  BorderThickness="1"
                                  CornerRadius="8"
                                  Padding="12,10"
                                  Margin="0,8,0,0">
                            <ScrollViewer MaxHeight="320"
                                          HorizontalScrollBarVisibility="Disabled"
                                          VerticalScrollBarVisibility="Auto">
                              <ContentPresenter Content="{TemplateBinding SkillsContent}" />
                            </ScrollViewer>
                          </Border>
                        </TabItem>

                        <TabItem Name="PART_ToolsTab" Header="Tools">
                          <Border Background="{DynamicResource Brush.Surface0}"
                                  BorderBrush="{DynamicResource Brush.BorderSubtle}"
                                  BorderThickness="1"
                                  CornerRadius="8"
                                  Padding="12,10"
                                  Margin="0,8,0,0">
                            <ScrollViewer MaxHeight="320"
                                          HorizontalScrollBarVisibility="Disabled"
                                          VerticalScrollBarVisibility="Auto">
                              <ContentPresenter Content="{TemplateBinding ToolsContent}" />
                            </ScrollViewer>
                          </Border>
                        </TabItem>
                      </TabControl>
                    </StackPanel>
                  </Border>
                </StackPanel>
              </Border>
            </Panel>
          </ControlTemplate>
        </Setter>

        <Style Selector="^:expanded /template/ Border#PART_Detail">
          <Setter Property="MaxHeight" Value="1200" />
          <Setter Property="Opacity" Value="1" />
          <Setter Property="RenderTransform" Value="translateY(0) scaleY(1)" />
        </Style>

        <Style Selector="^:not(:has-detail) /template/ TextBlock#PART_EmptyText">
          <Setter Property="IsVisible" Value="True" />
        </Style>

        <Style Selector="^:not(:has-detail) /template/ controls|StrataMarkdown#PART_Markdown">
          <Setter Property="IsVisible" Value="False" />
        </Style>

        <Style Selector="^:not(:has-skills) /template/ TabItem#PART_SkillsTab">
          <Setter Property="IsVisible" Value="False" />
        </Style>

        <Style Selector="^:not(:has-tools) /template/ TabItem#PART_ToolsTab">
          <Setter Property="IsVisible" Value="False" />
        </Style>

        <Style Selector="^:not(:has-description) /template/ TextBlock#PART_Description">
          <Setter Property="IsVisible" Value="False" />
        </Style>

        <Style Selector="^:expanded /template/ Border#PART_Root">
          <Setter Property="BorderBrush" Value="{DynamicResource Brush.AccentDefault}" />
          <Setter Property="Background" Value="{DynamicResource Brush.SurfaceCardHover}" />
          <Setter Property="BoxShadow" Value="0 4 16 0 #14000000" />
        </Style>

        <Style Selector="^:expanded /template/ Border#PART_Stratum">
          <Setter Property="Height" Value="3" />
          <Setter Property="Background" Value="{DynamicResource Brush.AccentGradient}" />
        </Style>

        <Style Selector="^:pointerover /template/ Border#PART_Root">
          <Setter Property="Background" Value="{DynamicResource Brush.SurfaceCardHover}" />
          <Setter Property="BorderBrush" Value="{DynamicResource Brush.BorderDefault}" />
        </Style>

        <Style Selector="^:focus-visible /template/ Border#PART_FocusRing">
          <Setter Property="BorderBrush" Value="{DynamicResource Brush.AccentGradient}" />
        </Style>
      </ControlTheme>
    </ResourceDictionary>
  </Styles.Resources>
</Styles>
