<Styles xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:controls="using:StrataTheme.Controls">

  <Styles.Resources>
    <ResourceDictionary>
      <ControlTheme x:Key="{x:Type controls:StrataFileAttachment}" TargetType="controls:StrataFileAttachment">
        <Setter Property="Focusable" Value="True" />
        <Setter Property="HorizontalAlignment" Value="Left" />
        <Setter Property="Template">
          <ControlTemplate>
            <Panel>
              <!-- Focus ring -->
              <Border Name="PART_FocusRing"
                      CornerRadius="10"
                      BorderThickness="2"
                      BorderBrush="Transparent"
                      Margin="-2"
                      IsHitTestVisible="False" />

              <Border Name="PART_Root"
                      Cursor="Hand"
                      Background="{DynamicResource Brush.Surface0}"
                      BorderBrush="{DynamicResource Brush.BorderSubtle}"
                      BorderThickness="1"
                      CornerRadius="8"
                      ClipToBounds="True"
                      Padding="0">
                <Border.Transitions>
                  <Transitions>
                    <BrushTransition Property="Background" Duration="0:0:0.14" />
                    <BrushTransition Property="BorderBrush" Duration="0:0:0.14" />
                    <BoxShadowsTransition Property="BoxShadow" Duration="0:0:0.18" />
                  </Transitions>
                </Border.Transitions>

                <DockPanel>
                  <!-- Top stratum line -->
                  <Border Name="PART_Stratum"
                          DockPanel.Dock="Top"
                          Height="2"
                          Background="{DynamicResource Brush.AccentGradient}"
                          Opacity="0.7">
                    <Border.Transitions>
                      <Transitions>
                        <BrushTransition Property="Background" Duration="0:0:0.14" />
                      </Transitions>
                    </Border.Transitions>
                  </Border>

                  <Grid ColumnDefinitions="Auto,8,*,6,Auto" Margin="10,7,6,7">
                    <!-- Icon -->
                    <Border Grid.Column="0"
                            Width="28" Height="28"
                            CornerRadius="6"
                            Background="{DynamicResource Brush.Surface1}"
                            VerticalAlignment="Center">
                      <TextBlock Text="{TemplateBinding IconGlyph}"
                                 FontSize="14"
                                 HorizontalAlignment="Center"
                                 VerticalAlignment="Center" />
                    </Border>

                    <!-- Name + meta -->
                    <StackPanel Grid.Column="2" Spacing="1" VerticalAlignment="Center">
                      <TextBlock Text="{TemplateBinding FileName}"
                                 FontSize="12"
                                 FontWeight="SemiBold"
                                 Foreground="{DynamicResource Brush.TextPrimary}"
                                 TextTrimming="CharacterEllipsis"
                                 MaxWidth="180" />
                      <StackPanel Orientation="Horizontal" Spacing="6">
                        <TextBlock Name="PART_SizeText"
                                   Text="{TemplateBinding FileSize}"
                                   FontSize="10.5"
                                   Foreground="{DynamicResource Brush.TextTertiary}" />
                        <Border Name="PART_StatusDot"
                                Width="5" Height="5"
                                CornerRadius="2.5"
                                VerticalAlignment="Center"
                                Background="{DynamicResource Brush.AccentDefault}" />
                        <TextBlock Text="{Binding StatusText, RelativeSource={RelativeSource TemplatedParent}}"
                                   FontSize="10.5"
                                   Foreground="{DynamicResource Brush.TextTertiary}" />
                      </StackPanel>
                    </StackPanel>

                    <!-- Remove button -->
                    <Button Name="PART_RemoveButton"
                            Grid.Column="4"
                            IsVisible="False"
                            Width="22" Height="22"
                            Padding="0"
                            VerticalAlignment="Center"
                            Background="Transparent"
                            BorderThickness="0"
                            Cursor="Hand"
                            ToolTip.Tip="Remove attachment">
                      <TextBlock Text="✕"
                                 FontSize="12"
                                 FontWeight="SemiBold"
                                 Foreground="{DynamicResource Brush.TextTertiary}"
                                 HorizontalAlignment="Center"
                                 VerticalAlignment="Center" />
                    </Button>
                  </Grid>
                </DockPanel>
              </Border>
            </Panel>
          </ControlTemplate>
        </Setter>

        <!-- Removable → show button -->
        <Style Selector="^:removable /template/ Button#PART_RemoveButton">
          <Setter Property="IsVisible" Value="True" />
        </Style>

        <!-- Remove button hover -->
        <Style Selector="^ /template/ Button#PART_RemoveButton:pointerover TextBlock">
          <Setter Property="Foreground" Value="{DynamicResource Brush.DangerDefault}" />
        </Style>

        <!-- Card hover -->
        <Style Selector="^:pointerover /template/ Border#PART_Root">
          <Setter Property="BorderBrush" Value="{DynamicResource Brush.BorderDefault}" />
          <Setter Property="Background" Value="{DynamicResource Brush.Surface1}" />
          <Setter Property="BoxShadow" Value="0 2 8 0 #12000000" />
        </Style>

        <!-- ── Status: Pending ── -->
        <Style Selector="^:pending /template/ Border#PART_StatusDot">
          <Setter Property="Background" Value="{DynamicResource Brush.TextTertiary}" />
        </Style>
        <Style Selector="^:pending /template/ Border#PART_Stratum">
          <Setter Property="Background" Value="{DynamicResource Brush.TextTertiary}" />
          <Setter Property="Opacity" Value="0.5" />
        </Style>

        <!-- ── Status: Uploading ── -->
        <Style Selector="^:uploading /template/ Border#PART_StatusDot">
          <Setter Property="Background" Value="{DynamicResource Brush.AccentDefault}" />
        </Style>
        <Style Selector="^:uploading /template/ Border#PART_Stratum">
          <Setter Property="Background" Value="{DynamicResource Brush.AccentGradient}" />
          <Style.Animations>
            <Animation Duration="0:0:1.1" IterationCount="Infinite">
              <KeyFrame Cue="0%">
                <Setter Property="Opacity" Value="0.5" />
              </KeyFrame>
              <KeyFrame Cue="50%">
                <Setter Property="Opacity" Value="1" />
              </KeyFrame>
              <KeyFrame Cue="100%">
                <Setter Property="Opacity" Value="0.5" />
              </KeyFrame>
            </Animation>
          </Style.Animations>
        </Style>

        <!-- ── Status: Completed ── -->
        <Style Selector="^:completed /template/ Border#PART_StatusDot">
          <Setter Property="Background" Value="{DynamicResource Brush.SuccessDefault}" />
        </Style>
        <Style Selector="^:completed /template/ Border#PART_Stratum">
          <Setter Property="Background" Value="{DynamicResource Brush.SuccessDefault}" />
          <Setter Property="Opacity" Value="0.85" />
        </Style>

        <!-- ── Status: Failed ── -->
        <Style Selector="^:failed /template/ Border#PART_StatusDot">
          <Setter Property="Background" Value="{DynamicResource Brush.DangerDefault}" />
        </Style>
        <Style Selector="^:failed /template/ Border#PART_Stratum">
          <Setter Property="Background" Value="{DynamicResource Brush.DangerDefault}" />
          <Setter Property="Opacity" Value="0.85" />
        </Style>

        <!-- Focus -->
        <Style Selector="^:focus-visible /template/ Border#PART_FocusRing">
          <Setter Property="BorderBrush" Value="{DynamicResource Brush.AccentGradient}" />
        </Style>
      </ControlTheme>
    </ResourceDictionary>
  </Styles.Resources>
</Styles>
