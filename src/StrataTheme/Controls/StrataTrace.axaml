<Styles xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:controls="using:StrataTheme.Controls">
  <Styles.Resources>
    <ResourceDictionary>
      <ControlTheme x:Key="{x:Type controls:StrataTrace}" TargetType="controls:StrataTrace">
        <Setter Property="Focusable" Value="True" />
        <Setter Property="Template">
          <ControlTemplate>
            <StackPanel Spacing="0">
              <!-- Inline citation badge -->
              <Border Name="PART_Badge"
                      Cursor="Hand"
                      Background="{DynamicResource Brush.AccentSubtle}"
                      CornerRadius="3"
                      Padding="4,1"
                      VerticalAlignment="Center"
                      HorizontalAlignment="Left"
                      RenderTransformOrigin="0.5,0.5"
                      RenderTransform="scale(1)">
                <Border.Transitions>
                  <Transitions>
                    <BrushTransition Property="Background" Duration="0:0:0.14" />
                    <TransformOperationsTransition Property="RenderTransform" Duration="0:0:0.12" Easing="CubicEaseOut" />
                  </Transitions>
                </Border.Transitions>
                <TextBlock Foreground="{DynamicResource Brush.AccentDefault}"
                           FontSize="10"
                           FontWeight="Bold"
                           Text="{TemplateBinding IndexText}" />
              </Border>

              <!-- Expanded source card -->
              <Border Name="PART_SourceCard"
                      ClipToBounds="True"
                      MaxHeight="0"
                      Opacity="0"
                      Background="{DynamicResource Brush.Surface1}"
                      BorderBrush="{DynamicResource Brush.BorderSubtle}"
                      BorderThickness="{DynamicResource Stroke.Thin}"
                      CornerRadius="{DynamicResource Radius.Base}"
                      Padding="10,8"
                      Margin="0,4,0,0"
                      HorizontalAlignment="Stretch">
                <Border.Transitions>
                  <Transitions>
                    <DoubleTransition Property="MaxHeight" Duration="0:0:0.22" Easing="CubicEaseOut" />
                    <DoubleTransition Property="Opacity" Duration="0:0:0.18" />
                  </Transitions>
                </Border.Transitions>
                <StackPanel Spacing="4">
                  <DockPanel>
                    <TextBlock Text="{TemplateBinding Title}"
                               FontSize="12" FontWeight="SemiBold"
                               Foreground="{DynamicResource Brush.TextPrimary}"
                               TextTrimming="CharacterEllipsis" />
                    <TextBlock Name="PART_RelevanceText"
                               DockPanel.Dock="Right"
                               FontSize="10" FontWeight="SemiBold"
                               Foreground="{DynamicResource Brush.AccentDefault}"
                               VerticalAlignment="Center"
                               Margin="8,0,0,0" />
                  </DockPanel>
                  <TextBlock Text="{TemplateBinding Snippet}"
                             FontSize="11"
                             Foreground="{DynamicResource Brush.TextSecondary}"
                             TextWrapping="Wrap"
                             MaxLines="3"
                             TextTrimming="CharacterEllipsis" />
                  <TextBlock Text="{TemplateBinding Origin}"
                             FontSize="10"
                             Foreground="{DynamicResource Brush.TextTertiary}"
                             TextTrimming="CharacterEllipsis" />
                </StackPanel>
              </Border>
            </StackPanel>
          </ControlTemplate>
        </Setter>

        <!-- Hover on badge -->
        <Style Selector="^ /template/ Border#PART_Badge:pointerover">
          <Setter Property="Background" Value="{DynamicResource Brush.AccentDefault}" />
          <Setter Property="RenderTransform" Value="scale(1.1)" />
        </Style>
        <Style Selector="^ /template/ Border#PART_Badge:pointerover TextBlock">
          <Setter Property="Foreground" Value="{DynamicResource Brush.TextOnAccent}" />
        </Style>

        <!-- Revealed state -->
        <Style Selector="^[IsRevealed=True] /template/ Border#PART_SourceCard">
          <Setter Property="MaxHeight" Value="200" />
          <Setter Property="Opacity" Value="1" />
        </Style>
        <Style Selector="^[IsRevealed=True] /template/ Border#PART_Badge">
          <Setter Property="Background" Value="{DynamicResource Brush.AccentDefault}" />
        </Style>
        <Style Selector="^[IsRevealed=True] /template/ Border#PART_Badge TextBlock">
          <Setter Property="Foreground" Value="{DynamicResource Brush.TextOnAccent}" />
        </Style>

        <Style Selector="^:focus-visible /template/ Border#PART_Badge">
          <Setter Property="BorderBrush" Value="{DynamicResource Brush.AccentDefault}" />
          <Setter Property="BorderThickness" Value="1" />
        </Style>
      </ControlTheme>
    </ResourceDictionary>
  </Styles.Resources>
</Styles>
